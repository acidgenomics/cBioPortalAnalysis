<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Get normalized RNA-seq expression data — rnaSeqData • cBioPortalAnalysis</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Get normalized RNA-seq expression data — rnaSeqData" />
<meta property="og:description" content="Get normalized RNA-seq expression data" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cBioPortalAnalysis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://acidgenomics.com/">
    <span class="fas fa fas fa-vial fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/acidgenomics/cBioPortalAnalysis/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Get normalized RNA-seq expression data</h1>
    <small class="dont-index">Source: <a href='https://github.com/acidgenomics/cBioPortalAnalysis/blob/master/R/rnaSeqData.R'><code>R/rnaSeqData.R</code></a></small>
    <div class="hidden name"><code>rnaSeqData.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Get normalized RNA-seq expression data</p>
    </div>

    <pre class="usage"><span class='fu'>rnaSeqData</span><span class='op'>(</span>
  <span class='va'>cancerStudies</span>,
  <span class='va'>geneNames</span>,
  zscore <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"all samples"</span>, <span class='st'>"diploid samples"</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>cancerStudies</th>
      <td><p><code>character</code>.
Cancer study IDs.
See <code><a href='cancerStudies.html'>cancerStudies()</a></code> for details.</p></td>
    </tr>
    <tr>
      <th>geneNames</th>
      <td><p><code>character</code>.
HUGO gene symbols (e.g. "TP53").</p></td>
    </tr>
    <tr>
      <th>zscore</th>
      <td><p><code>character</code>.</p><ul>
<li><p><code>"all samples"</code>:
mRNA expression z-Scores relative to all samples (log RNA Seq RPKM).
Log-transformed mRNA z-Scores compared to the expression distribution of
all samples (RNA Seq RPKM).</p></li>
<li><p><code>"diploid samples"</code>:
mRNA expression z-Scores relative to diploid samples (RNA Seq RPKM).
mRNA z-Scores (RNA Seq RPKM) compared to the expression distribution of
each gene tumors that are diploid for this gene.</p></li>
</ul></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>DataFrame</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Examples of cancer studies with different mRNA data types:</p><ul>
<li><p>RNA-seq v2: <code>gbm_tcga_pub2013_rna_seq_v2_mrna</code>.</p></li>
<li><p>RNA-seq v1: <code>nbl_target_2018_pub_rna_seq_mrna</code>.</p></li>
<li><p>Microarray: <code>gbm_tcga_pub_mrna</code>.</p></li>
</ul>

    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Updated 2020-10-09.</p>
    <h2 class="hasAnchor" id="the-cbioportal-z-score-calculation-method"><a class="anchor" href="#the-cbioportal-z-score-calculation-method"></a>The cBioPortal Z-Score calculation method</h2>

    


<p>cBioPortal currently generates two z-score profiles using two different base
populations:</p>
<p>Distribution based on <strong>diploid</strong> samples only: The expression distribution
for unaltered copies of the gene is estimated by calculating the mean and
variance of the expression values for samples in which the gene is diploid
(i.e. value is "0" as reported by discrete CNA data). We call this the
unaltered distribution. If the gene has no diploid samples, then its
normalized expression is reported as <code>NA</code>.</p>
<p>Distribution based on <strong>all</strong> samples: The expression distribution of the
gene is estimated by calculating the mean and variance of all samples with
expression values (excludes zero's and non-numeric values like <code>NA</code>, <code>NULL</code>
or <code>NaN</code>). If the gene has samples whose expression values are all zeros or
non-numeric, then its normalized expression is reported as <code>NA</code>.</p>
<p>Otherwise for every sample, the gene's normalized expression for both the
profiles is reported as:</p><pre><span class='op'>(</span><span class='va'>r</span> <span class='op'>-</span> <span class='va'>mu</span><span class='op'>)</span><span class='op'>/</span><span class='va'>sigma</span>
</pre>

<p>where <code>r</code> is the raw expression value, and <code>mu</code> and <code>sigma</code> are the mean and
standard deviation of the base population, respectively.</p>
<p>See also:
https://github.com/cBioPortal/cbioportal/blob/master/docs/Z-Score-normalization-script.md</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>cancerStudies</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"acc_tcga_pan_can_atlas_2018"</span>, <span class='st'>"ccle_broad_2019"</span><span class='op'>)</span>
<span class='va'>geneNames</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"MYC"</span>, <span class='st'>"TP53"</span><span class='op'>)</span>
<span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'>rnaSeqData</span><span class='op'>(</span>cancerStudies <span class='op'>=</span> <span class='va'>cancerStudies</span>, geneNames <span class='op'>=</span> <span class='va'>geneNames</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span>
</div><div class='output co'>#&gt; DataFrame with 1234 rows and 4 columns
#&gt;                      cancerStudy                     sampleID       MYC
#&gt;                      &lt;character&gt;                  &lt;character&gt; &lt;logical&gt;
#&gt; 1    acc_tcga_pan_can_atlas_2018                   A101D_SKIN        NA
#&gt; 2    acc_tcga_pan_can_atlas_2018 A1207_CENTRAL_NERVOUS_SYSTEM        NA
#&gt; 3    acc_tcga_pan_can_atlas_2018  A172_CENTRAL_NERVOUS_SYSTEM        NA
#&gt; 4    acc_tcga_pan_can_atlas_2018             A204_SOFT_TISSUE        NA
#&gt; 5    acc_tcga_pan_can_atlas_2018                   A2058_SKIN        NA
#&gt; ...                          ...                          ...       ...
#&gt; 1230             ccle_broad_2019              TCGA.PA.A5YG.01        NA
#&gt; 1231             ccle_broad_2019              TCGA.PK.A5H8.01        NA
#&gt; 1232             ccle_broad_2019              TCGA.PK.A5H9.01        NA
#&gt; 1233             ccle_broad_2019              TCGA.PK.A5HA.01        NA
#&gt; 1234             ccle_broad_2019              TCGA.PK.A5HB.01        NA
#&gt;           TP53
#&gt;      &lt;logical&gt;
#&gt; 1           NA
#&gt; 2           NA
#&gt; 3           NA
#&gt; 4           NA
#&gt; 5           NA
#&gt; ...        ...
#&gt; 1230        NA
#&gt; 1231        NA
#&gt; 1232        NA
#&gt; 1233        NA
#&gt; 1234        NA</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://steinbaugh.com/'>Michael Steinbaugh</a>, <a href='https://acidgenomics.com/'>Acid Genomics</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


